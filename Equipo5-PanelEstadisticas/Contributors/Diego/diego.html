<!DOCTYPE html>
<html lang="es" class="transition-colors">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diego - Panel de Estad√≠sticas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/Equipo5-PanelEstadisticas/Styles/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Configuraci√≥n de Tailwind -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#7772e7',
                        secondary: '#e2e772',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Urbanist', sans-serif; }
    </style>

    <!-- Inicializaci√≥n de tema ANTES de que cargue el contenido -->
    <script>
        if (localStorage.getItem('color-theme') === 'dark' || 
            (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        }
    </script>

    <!-- Flowbite para Tabs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.0/flowbite.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body class="bg-secondary dark:bg-[#121212] min-h-screen transition-colors">
    <!-- Barra lateral -->
       <nav class="fixed top-5 left-5 bottom-5 w-20 bg-primary dark:bg-[#5751a8] flex flex-col items-center py-4 z-50 rounded-2xl shadow-lg overflow-y-auto">
        <ul class="flex flex-col gap-5 h-full justify-start">
            <li>
                <a class="w-14 h-14 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-bold text-2xl no-underline" href="/index.html">Z</a>
            </li>
            <li>
                <a href="/Equipo5-PanelEstadisticas/landing/index.html" class="flex items-center justify-center w-14 h-14 rounded-full bg-white dark:bg-gray-700 shadow hover:bg-secondary dark:hover:bg-white transition">
                    <span class="material-icons text-primary dark:text-[#a8a4e9] text-3xl">home</span>
                </a>
            </li>
            <li>
                <a href="/Equipo5-PanelEstadisticas/Contributors/Mariana/mariana.html" class="flex items-center justify-center w-14 h-14 rounded-full bg-white dark:bg-secondary shadow hover:bg-secondary dark:hover:bg-white transition">
                    <img src="/Equipo5-PanelEstadisticas/landing/assets/images/MARIANA.png" alt="Mariana Icono" class="w-12 h-12 rounded-full object-cover" />
                </a>
            </li>
            <li>
                <a href="/Equipo5-PanelEstadisticas/Contributors/Mateo/mateo.html" class="flex items-center justify-center w-14 h-14 rounded-full bg-white dark:bg-secondary shadow hover:bg-secondary dark:hover:bg-white transition">
                     <img src="/Equipo5-PanelEstadisticas/landing/assets/images/MATEO.png" alt="Mateo Icono" class="w-12 h-12 rounded-full object-cover" />
                </a>
            </li>
            <li>
                <a href="/Equipo5-PanelEstadisticas/Contributors/Jhon/jhon.html" class="flex items-center justify-center w-14 h-14 rounded-full bg-white dark:bg-secondary shadow hover:bg-secondary dark:hover:bg-white transition">
                     <img src="/Equipo5-PanelEstadisticas/landing/assets/images/JHON.png" alt="Jhon Icono" class="w-12 h-12 rounded-full object-cover" />
                </a>
            </li>
            <li>
                <a href="/Equipo5-PanelEstadisticas/Contributors/Andrea/andrea.html" class="flex items-center justify-center w-14 h-14 rounded-full bg-white dark:bg-secondary shadow hover:bg-secondary dark:hover:bg-white transition">
                    <img src="/Equipo5-PanelEstadisticas/landing/assets/images/ANDREA.png" alt="Andrea Icono" class="w-12 h-12 rounded-full object-cover" />
                </a>
            </li>
            <li>
                <a href="/Equipo5-PanelEstadisticas/Contributors/Diego/diego.html" class="flex items-center justify-center w-14 h-14 rounded-full bg-white dark:bg-secondary shadow hover:bg-secondary dark:hover:bg-white transition">
                    <img src="/Equipo5-PanelEstadisticas/landing/assets/images/DIEGO.png" alt="Diego Icono" class="w-12 h-12 rounded-full object-cover" />
                </a>
            </li>
        </ul>
    </nav>

    <header class="fixed left-32 top-5 right-7 h-20 bg-gradient-to-r from-primary to-secondary dark:from-[#5751a8] dark:to-[#b3b747] flex items-center gap-4 px-8 shadow-lg z-40 rounded-2xl">
        <h1 class="text-white text-3xl font-extrabold m-0">Panel de Estad√≠sticas</h1>

        <!-- Bot√≥n de Modo Oscuro -->
        <button id="theme-toggle" type="button" class="ml-auto text-white bg-white/10 rounded-full p-2 transition-colors">
            <span class="material-icons dark:hidden">light_mode</span>
            <span class="material-icons hidden dark:block">dark_mode</span>
        </button>
    </header>
    <main>
        <section class="pt-36 px-8">
            <div class="flex items-center justify-center">
                <div class="card bg-white p-8 rounded-lg shadow-lg flex flex-col items-center">
                    <h2 class="text-2xl font-bold mb-4">Bienvenido üëã</h2>
                    <p class="description mb-2">Iniciaste sesi√≥n las siguientes veces:</p>
                    <div id="counter" class="counter text-4xl font-mono mb-6">0</div>
                    <div class="flex gap-4">
                        <button id="landingBtn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">Volver</button>
                        <button id="exitBtn" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition">Salir</button>
                    </div>
                </div>
            </div>
        </section>
        <!-- Historial de eventos asistidos -->
        <section id="historial" class="pt-8 px-8 pb-16">
            <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-4xl mx-auto dark:bg-[#0f1720]">
                <h2 class="text-2xl font-bold mb-4 text-center text-gray-800 dark:text-gray-100">Historial de Eventos Asistidos</h2>
                <p class="text-sm text-center mb-4 text-gray-600 dark:text-gray-300">Haz clic en "Fecha" para ordenar por fecha.</p>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead>
                            <tr>
                                <th id="fechaHeader" class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none">
                                    Fecha <span id="fechaSortIcon" class="inline-block ml-1 text-sm">‚¨Ü</span>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">T√≠tulo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">Duraci√≥n</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">Modalidad</th>
                            </tr>
                        </thead>
                        <tbody id="eventosBody" class="bg-white divide-y divide-gray-100 dark:bg-transparent dark:divide-gray-700">

                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Navegar al landing
        const landingBtn = document.getElementById('landingBtn');
        if (landingBtn) {
            landingBtn.addEventListener('click', function() {
                window.location.href = '/Equipo5-PanelEstadisticas/landing/index.html';
            });
        }

        // Cargar y mostrar contador desde localStorage
        const counterEl = document.getElementById('counter');
        const stored = localStorage.getItem('contadorSesion');
        let contador = stored !== null ? Number(stored) : 0;
        if (counterEl) counterEl.textContent = contador;

        // Bot√≥n salir: reinicia el contador
        const exitBtn = document.getElementById('exitBtn');
        if (exitBtn) {
            exitBtn.addEventListener('click', function(){
                localStorage.setItem('contadorSesion', 0);
                if (counterEl) counterEl.textContent = 0;
            });
        }
    </script>

    <script>
        // Listener del toggle de tema (mantenido del documento original)
        document.addEventListener('DOMContentLoaded', () => {
            const toggle = document.getElementById('theme-toggle');
            if (toggle) {
                toggle.addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                    if (document.documentElement.classList.contains('dark')) {
                        localStorage.setItem('color-theme', 'dark');
                    } else {
                        localStorage.setItem('color-theme', 'light');
                    }
                });
            }
        });
    </script>

    <!-- Script para Historial de Eventos (separado, sin interferir con otros scripts) -->
    <script>
        (function(){
            // Datos ampliados de ejemplo
            const eventos = [
                { fecha: '2025-08-20', titulo: 'Taller de Mindfulness', duracion: '2h', modalidad: 'Presencial' },
                { fecha: '2025-07-15', titulo: 'Charla de Autoestima', duracion: '1.5h', modalidad: 'Online' },
                { fecha: '2025-08-10', titulo: 'Sesi√≥n grupal', duracion: '2h', modalidad: 'Presencial' },
                { fecha: '2025-06-30', titulo: 'Webinar de Estr√©s', duracion: '1h', modalidad: 'Online' },
                { fecha: '2025-05-22', titulo: 'Taller de Respiraci√≥n', duracion: '1.5h', modalidad: 'H√≠brida' },
                { fecha: '2025-04-12', titulo: 'Taller de Gesti√≥n emocional', duracion: '3h', modalidad: 'Presencial' },
                { fecha: '2025-08-25', titulo: 'Retiro de Bienestar', duracion: '6h', modalidad: 'Presencial' }
            ];

            let ascendente = false; // mostrar los m√°s recientes primero por defecto

            // Convierte YYYY-MM-DD a timestamp para ordenar correctamente
            function fechaATimestamp(fecha) {
                const parts = fecha.split('-');
                return new Date(Number(parts[0]), Number(parts[1]) - 1, Number(parts[2])).getTime();
            }

            function renderTabla() {
                const tbody = document.getElementById('eventosBody');
                if (!tbody) return;
                tbody.innerHTML = '';
                eventos.forEach(ev => {
                    const tr = document.createElement('tr');
                    tr.className = 'hover:bg-gray-50 dark:hover:bg-gray-900';
                    tr.innerHTML = `\
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${ev.fecha}</td>\
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-gray-100">${ev.titulo}</td>\
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${ev.duracion}</td>\
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${ev.modalidad}</td>\
                    `;
                    tbody.appendChild(tr);
                });
            }

            function ordenarPorFecha() {
                eventos.sort((a, b) => {
                    return ascendente ? fechaATimestamp(a.fecha) - fechaATimestamp(b.fecha) : fechaATimestamp(b.fecha) - fechaATimestamp(a.fecha);
                });
                const icon = document.getElementById('fechaSortIcon');
                if (icon) icon.textContent = ascendente ? '‚¨Ü' : '‚¨á';
                ascendente = !ascendente;
                renderTabla();
            }

            // Inicial
            document.addEventListener('DOMContentLoaded', function(){
                // ordenar inicialmente
                eventos.sort((a,b) => fechaATimestamp(b.fecha) - fechaATimestamp(a.fecha));
                renderTabla();

                const header = document.getElementById('fechaHeader');
                if (header) header.addEventListener('click', ordenarPorFecha);
            });
        })();
    </script>

</body>
</html>
